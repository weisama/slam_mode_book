# 快速入门使用模块，以及简单测试其功能

## 1.接线介绍

印有logo为模块顶面，正面接XH2.54mm插头用于输出坐标，背面usb接雷达、type-C给模块供电

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/4ab15165-7ff0-4709-86cf-b26da3973aec" width="100%">
    </td>
  </tr>
</table>

**正面5V为双向供电，即type-C供电时模块可对外供电，也可通过5V给模块供电，推荐使用前者作为供电方式**

## 2.使用上位机

[下载上位机最新版](https://github.com/kikiYang03/SerialPortAssistant/releases)

**选择最新版下载**

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/78f81147-2376-457f-a0f2-8693a8a82248" width="80%">
    </td>
  </tr>
</table>

模块接线如图：

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/e113c383-4b0a-47ef-98d5-7ee1083a8c50" width="100%">
    </td>
  </tr>
</table>

上电后，等待模块初始化10s，连接模块热点（密码12345678）：

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/571f7fb4-060f-425d-a219-6a3532111917" width="200%">
    </td>
  </tr>
</table>

启动上位机，点击[打开连接]，连接成功后可以看见上位机收到大量数据：

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/b0fe5423-52bf-43c5-8332-279a870c3d77" width="80%">
    </td>
  </tr>
</table>

点击[发送测试数据]，模块成功测试成功：

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/4eb31435-bb1d-48d7-a418-96a01b1c0723" width="80%">
    </td>
  </tr>
</table>

进入可视化界面，可以看见机器人坐标，箭头代表机器人，红点为雷达点云，黑白色块为建图

**红色坐标轴（默认参数为机器人前方）为X+方向，蓝色坐标轴（默认参数为机器人左方）为Y+方向**

**模块启动时以X+为0度，顺时针转动范围0到180度，逆时针转动范围0到-180度**

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/138d3de9-65e6-4b36-9b97-0d1f37dd6b0b" width="80%">
    </td>
  </tr>
</table>

机器人围绕房间一圈，可以看见蓝色曲线为机器人行驶路径，建图逐渐完整显现出房间的轮廓

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/52d1aac5-6ef3-4a3a-86b3-acbfc9eb5849" width="80%">
    </td>
  </tr>
</table>

## 3.上机测试，串口通信或px4飞控定点飞行

### 3.1若机器人主控使用单片机或其他可串口通信的设备，测试模块的串口输出坐标功能

模块接线如图：

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/bb067858-c273-4ac0-99c6-6213cdc414a2" width="100%">
    </td>
  </tr>
</table>

上电后，等待模块初始化10s，连接模块热点（密码12345678）

打开上位机，连接串口后，可以看见接接收到大量数据

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/1124699b-ce2e-4baf-92ec-0b602f79c968" width="80%">
    </td>
  </tr>
</table>

上位机从数据中解析出坐标，模块串口输出坐标功能测试成功

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/9423cab7-4ae7-4193-a62d-b089ecdb1421" width="80%">
    </td>
  </tr>
</table>

#### **通信协议格式**

**波特率115200，字节格式为8N1**

| 字节序号       | 名称      | 长度     | 说明        | 单位       | 备注        |
| ---------- | ------- | ------ | --------- | -------- | --------- |
| **Byte 0** | 帧头      | 1 byte | 固定 `0xAA` | —        | 起始标志      |
| **Byte 1** | X 高字节   | 1 byte | X 坐标高 8 位 | **cm**   | int16 高字节 |
| **Byte 2** | X 低字节   | 1 byte | X 坐标低 8 位 | **cm**   | int16 低字节 |
| **Byte 3** | Y 高字节   | 1 byte | Y 坐标高 8 位 | **cm**   | int16 高字节 |
| **Byte 4** | Y 低字节   | 1 byte | Y 坐标低 8 位 | **cm**   | int16 低字节 |
| **Byte 5** | Z 高字节   | 1 byte | Z 坐标高 8 位 | **cm**   | int16 高字节 |
| **Byte 6** | Z 低字节   | 1 byte | Z 坐标低 8 位 | **cm**   | int16 低字节 |
| **Byte 7** | Yaw 高字节 | 1 byte | 航向角高字节    | **°（度）** | int16 高字节 |
| **Byte 8** | Yaw 低字节 | 1 byte | 航向角低字节    | **°（度）** | int16 低字节 |
| **Byte 9** | 帧尾      | 1 byte | 固定 `0x0A` | —        | 结束标志      |

例如串口收到数据：
AA 00 7B FF D3 00 4E 00 3C 0A

解析后得到： 
x = 123 cm，y = -45 cm，z = 78 cm，yaw = 60°

[使用STM32单片机，串口接收并解析数据教程](https://github.com/weisama/slam_mode_book/blob/main/2.%E4%BD%BF%E7%94%A8STM32%E8%AF%BB%E5%8F%96slam_mode%E4%B8%B2%E5%8F%A3%E6%95%B0%E6%8D%AE%E5%B9%B6%E8%A7%A3%E6%9E%90.md)

### 3.2若机器人主控使用px4架构飞控（pixhawk），测试模块作为飞控的位置输入传感器

模块接线如图（以pixhawk 6c mini飞控为例）：

<table>
  <tr>
    <td style="border: 10px solid black; padding: 0;">
      <img src="https://github.com/user-attachments/assets/9d536db0-9f66-4be2-8aa1-75718c4331ee" width="100%">
    </td>
  </tr>
</table>

需准备一架可起飞的px4架构飞控的无人机，电脑下载上QGC

本教程以固件px4V1.13.3为例，飞控连接上QGC后设置参数如下：

设置参数后断电重连飞控确保参数生效
给模块上电，等待模块初始化10s，可在QGC的mavlink控制器中看见模块传给飞控的数据：

QGC中可以把飞控模式设置为定点

无人机已实现位置闭环，可起飞测试定点效果
